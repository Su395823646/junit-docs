# 测试驱动开发(讲义)

第一步，编写一个测试  
第二步，编写实现代码让所有测试通过  
第二步，在测试的保护下重构代码，消除代码中的坏味道

![](https://www.simbirsoft.com/upload/medialibrary/ebb/skhema1.jpg)

## 技巧

1. 编写测试前做好问题分解，形成任务项，进行跟踪。

   - 对要实现的功能（用户故事）进行分析， 列出要解决的问题，**形成清单**
   - 对每个问题进行分析，要么开始处理（通过 TDD 解决），要么将**问题拆分**成更小的问题加入清单
   - TDD 过程中发现**新的问题及时加入清单**
   - **一次处理（TDD）一个问题**，直到清单中所有问题解决完毕。

2. 熟练掌握重构手法

   - 识别哪些代码可以重构 

     - 留意**代码扫描工具结果和 IDE 提示**
     - 建立属于团队的必须重构的**代码坏味道 Checklist**，建议包括：魔数、重复代码、过长方法、过大类。
     - 通过**代码检视**活动，**统一团队对坏味道的标准**，提升对坏味道的敏感度

   - 知道有哪些安全的重构的手段

     - **熟悉 IDE 提供的重构功能，尤其是使用最多的几个**，包括：重命名、提取常量、提取方法、提取本地变量、提取成员变量，修改方法签名
     - 知道那种坏味道可以用哪（几）种重构手法解决
     - **小步重构**，大型重构可以拆解，用安全重构手段逐步完成。

   - **刻意练习**，比如，在重构时必须使用 IDE 的自动重构功能。

3. 编写实现代码之前做预先设计

   - 编写测试和代码之前**充分理解需求**。
   - 编写实现代码前**根据经验或者框架以及工具的约束做出必要的设计**，加快实现代码编写的速度。如类的设计、明显的设计模式、和 ORM 或者 DAO 模型的对接、与框架的对接等等。
